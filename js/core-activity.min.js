!function(){new Vue({el:"#vue-activity",data:JSON.parse(document.getElementById("vue-activity").getAttribute("data-env")),methods:{lastSearch:0,searchSubmit:function(){var vue=this;this.forms.search.errors={},this.forms.search.loading=!0;var soup=JSON.parse(JSON.stringify(this.forms.search));delete soup.page,delete soup.errors,delete soup.loading,delete soup.n,delete soup.action;var hash=this.hash(soup);hash!==this.lastSearch&&(this.forms.search.page=0,this.lastSearch=hash),this.formAjax(this.forms.search,function(r){vue.forms.search.loading=!1,vue.searched=!0,vue.results={page:0,pages:0,total:0,items:[]},r.ok&&r.data?vue.results=r.data:r.errors?vue.forms.search.errors=r.errors:vue.forms.search.errors.other="The server garbled the last response. :(",vue.scrollTo()})},pardonSubmit:function(id){var vue=this;this.forms.pardon.errors={},this.forms.pardon.loading=!0,this.forms.pardon.id=parseInt(id,10)||0,this.formAjax(this.forms.pardon,function(r){if(vue.forms.pardon.loading=!1,r.ok&&r.data){for(i=0;i<vue.results.bans.length;i++)vue.results.bans[i].id===id&&(vue.results.bans.splice(i,1),i=vue.results.bans.length);for(i=0;i<vue.results.items.length;i++)vue.results.items[i].id===id&&(vue.results.items[i].banned=!1,vue.results.items[i].banRemaining=0,vue.results.items[i].pardoned=1,i=vue.results.items.length)}else r.errors?vue.forms.pardon.errors=r.errors:vue.forms.pardon.errors.other="The server garbled the last response. :(";vue.scrollTo()})},downloadSubmit:function(){var vue=this;this.forms.download.errors={},this.forms.download.loading=!0,this.formAjax(this.forms.download,function(r){vue.forms.download.loading=!1,r.ok&&r.data?(vue.download=r.data.download,vue.downloadName=r.data.downloadName):r.errors?vue.forms.download.errors=r.errors:vue.forms.download.errors.other="The server garbled the last response. :(",vue.scrollTo()})},pageSubmit:function(change){if(0!==(change=parseInt(change,10)||0)&&(this.forms.search.page+=change,this.forms.search.page<0?this.forms.search.page=0:this.forms.search.page>this.results.pages&&(this.forms.search.page=this.results.pages),this.forms.search.page!==this.results.page))return this.searchSubmit()},toggleModal:function(modal){modal&&modal!==this.modal&&this.modals[modal]?this.modal=modal:this.modal=!1}},mounted:function(){this.searchSubmit()},filters:{status:function(status){return{ban:"Ban",fail:"Failure",success:"Success"}[status]},relativeTime:function(time){if((time=parseInt(time,10)||0)<=0)return"0s";var y=0,d=0,h=0,m=0,s=time;s-=60*(y=Math.floor(s/60/60/24/365))*60*24*365,s-=60*(d=Math.floor(s/60/60/24))*60*24,s-=60*(h=Math.floor(s/60/60))*60,s-=60*(m=Math.floor(s/60));var out=[];return y>0&&out.push(y+"y"),d>0&&out.push(d+"d"),h>0&&out.push(h+"h"),m>0&&out.push(m+"m"),s>0&&out.push(s+"s"),out.length>3&&out.splice(3),out.join(" ")}},computed:{returnedStatuses:function(){var statuses=[];if(this.results.total)for(i=0;i<this.results.items.length;i++)-1===statuses.indexOf(this.results.items[i].type)&&statuses.push(this.results.items[1].type);return statuses}}})}();